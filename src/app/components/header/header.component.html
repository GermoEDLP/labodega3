<header class="header">
  <div class="toggle-nav">
    <div
      class="icon-reorder tooltips"
      data-original-title="Toggle Navigation"
      data-placement="bottom"
    >
      <i class="icon_menu"></i>
    </div>
  </div>

  <!--logo start-->
  <a routerLink="/home" class="logo"
    ><img id="logo" src="assets/img/logo.png" alt=""
  /></a>
  <!--logo end-->

  <div class="nav search-row" id="top_menu">
    <!--  search form start -->
    <ul class="nav top-menu">
      <li>
        <form class="navbar-form">
          <input class="form-control" placeholder="Buscar" type="text" />
        </form>
      </li>
    </ul>
    <!--  search form end -->
  </div>

  <div class="top-nav notification-row">
    <!-- notificatoin dropdown start-->
    <ul class="nav pull-right top-menu">
      <!-- Cart start-->
      <li id="cart_notification" class="dropdown">
        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
          <i class="icon_cart_alt"></i>
          <span class="badge bg-important">{{cartCount}}</span>
        </a>
        <ul class="dropdown-menu extended notification" *ngIf="total">
          <div class="notify-arrow notify-arrow-blue"></div>
          <li>
            <p class="blue">Carrito</p>
          </li>

          <li *ngFor="let prod of cart; let i = index">
            <a href="#">
              <span class="label label-primary">{{prod.cant}}</span>
              {{prod.name}}
              <span class="small italic pull-right">$ {{total.promo[i].subtotal | number: '1.2-2'}}</span>
            </a>
          </li>

         
          <li>
            <a href="#" routerLink='/cart'
              >Total<span class="italic pull-right"> <b>{{total.subtotal | number: '1.2-2'}}$</b> </span></a
            >
          </li>
        </ul>
      </li>
      <!-- Cart end-->

      <!-- user login dropdown start-->
      <li class="dropdown" *ngIf="user$ | async  as user; else noSession">
        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
          <span class="profile-ava">
            <img alt="" src="assets/img/avatar1_small.jpg" />
          </span>
          <span class="username">{{user.displayName}}</span>
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu extended logout">
          <div class="log-arrow-up"></div>
          <li class="eborder-top">
            <a href="#"><i class="icon_profile"></i> Mi perfil</a>
          </li>
          <li>
            <a href="#"><i class="icon_clock_alt"></i> Historial de pedidos</a>
          </li>
          <li>
            <a href="#" routerLink="/cart"><i class="icon_cart_alt"></i> Carrito</a>
          </li>
          <li>
            <a (click)="logout()" href="#"><i class="icon_key_alt"></i> Cerrar sesión</a>
          </li>
        </ul>
      </li>

      <ng-template #noSession>
        <li class="dropdown">
          <a data-toggle="dropdown" class="dropdown-toggle" href="#">
            <span class="profile-ava">
              <img id="img_avatar" src="assets/img/avatar1.jpg" />
            </span>
            <span class="username">Anonimo</span>
            <b class="caret"></b>
          </a>
          <ul class="dropdown-menu extended logout">
            <div class="log-arrow-up"></div>
            <li>
              <a href="#"  routerLink="/cart"><i class="icon_cart_alt"></i> Carrito</a>
            </li>
            <li>
              <a data-toggle="modal" data-target="#mLogin" href="#"
                ><i class="icon_key_alt"></i> Iniciar sesión</a
              >
            </li>
          </ul>
        </li>
      </ng-template>
      <!-- user login dropdown end -->
    </ul>
    <!-- notificatoin dropdown end-->
  </div>
</header>

<!-- Modal Login -->
<div
  class="modal fade"
  id="mLogin"
  tabindex="-1"
  role="dialog"
  aria-labelledby="mLoginLabel"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title" id="mLoginLabel">Inicio de sesión</h4>
      </div>
      <app-login></app-login>
      
    </div>
  </div>
</div>

<!-- Modal Registro -->
<div
  class="modal fade"
  id="mRegistro"
  tabindex="-1"
  role="dialog"
  aria-labelledby="mLoginLabel"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title" id="mLoginLabel">Registrarse</h4>
      </div>

      <app-register></app-register>

    </div>
  </div>
</div>
